"use strict";var timerIDs=[];var callbacks=[];var types=[];var immediates=[];var requestIdleCallbacks=[];var requestIdleCallbackTimeouts={};var GUID=1;var errors=null;var hasEmittedTimeDriftWarning=false;function _getFreeIndex(){var freeIndex=timerIDs.indexOf(null);if(freeIndex===-1){freeIndex=timerIDs.length}return freeIndex}function _allocateCallback(func,type){var id=GUID++;var freeIndex=_getFreeIndex();timerIDs[freeIndex]=id;callbacks[freeIndex]=func;types[freeIndex]=type;return id}function _callTimer(timerID,frameTime,didTimeout){if(timerID>GUID){console.warn("Tried to call timer with ID %s but no such timer exists.",timerID)}var timerIndex=timerIDs.indexOf(timerID);if(timerIndex===-1){return}var type=types[timerIndex];var callback=callbacks[timerIndex];if(!callback||!type){console.error("No callback found for timerID "+timerID);return}if(type!=="setInterval"){_clearIndex(timerIndex)}try{if(type==="setTimeout"||type==="setInterval"||type==="setImmediate"||type==='setDisplayLink'||type==='setDisplayLinkOnce'){callback()}else{if(type==="requestIdleCallback"){callback({timeRemaining:function timeRemaining(){return Math.max(0,FRAME_DURATION-(global.performance.now()-frameTime))},didTimeout:!!didTimeout})}else{console.error("Tried to call a callback with invalid type: "+type)}}}catch(e){if(!errors){errors=[e]}else{errors.push(e)}}}function _callImmediatesPass(){if(immediates.length===0){return false}var passImmediates=immediates;immediates=[];for(var i=0;i<passImmediates.length;++i){_callTimer(passImmediates[i],0)}return immediates.length>0}function _clearIndex(i){timerIDs[i]=null;callbacks[i]=null;types[i]=null}function _freeCallback(timerID){if(timerID==null){return}var index=timerIDs.indexOf(timerID);if(index!==-1){var type=types[index];_clearIndex(index);if(type==='setTimeout'||type==='setInterval'){deleteTimer(timerID)}else if(type==='setDisplayLink'||type==='setDisplayLinkOnce'){deleteVsyncTimer(timerID)}}}function setTimeout(func,duration){for(var _len=arguments.length,args=Array(_len>2?_len-2:0),_key=2;_key<_len;_key++){args[_key-2]=arguments[_key]}var id=_allocateCallback(function(){return func.apply(undefined,args)},"setTimeout");createTimer(id,duration||0,Date.now(),false);return id}function createTimer(callbackId,duration,jsSchedulingTime,repeats){__NEZHA_BRIDGE__createTimer(callbackId,duration,jsSchedulingTime,repeats)}function callTimers(timersToCall){errors=null;for(var i=0;i<timersToCall.length;i++){_callTimer(timersToCall[i],0)}if(errors){var errorCount=errors.length;if(errorCount>1){for(var ii=1;ii<errorCount;ii++){setTimeout(function(error){throw error}.bind(null,errors[ii]),0)}}throw errors[0]}}function setInterval(func,duration){for(var _len2=arguments.length,args=Array(_len2>2?_len2-2:0),_key2=2;_key2<_len2;_key2++){args[_key2-2]=arguments[_key2]}var id=_allocateCallback(function(){return func.apply(undefined,args)},"setInterval");createTimer(id,duration||0,Date.now(),true);return id}function clearTimeout(timerID){_freeCallback(timerID)}function clearInterval(timerID){_freeCallback(timerID)}function clearDisplayLink(timerID){_freeCallback(timerID)}function deleteTimer(timerID){__NEZHA_BRIDGE__deleteTimer(timerID)}function createVsyncTimer(callbackId,duration,jsSchedulingTime,repeats){__NEZHA_BRIDGE__CREATE_VSYNC_TIMER(callbackId,duration,jsSchedulingTime,repeats)}function deleteVsyncTimer(timerID){__NEZHA_BRIDGE__DELETE_VSYNC_TIMER(timerID)};